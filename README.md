Service Graph AWS - Deployment scripts


|Module|File|Required|Input Variable(s)|Output Variable(s)|Comments|
|------|----|--------|--------|--------|--------|
|mgmtrole|SnowDesignatedAccountAccessRoleInManagementAccount|Optional|Member Account Number|ARN of ServiceNow OrganizationAccountAccessRole Role|This template creates the SnowOrganizationAccountAccessRole in the management account. The ServiceNow user, created in a delegated member account, requires access to organization details and the list of associated accounts.|
|memberrole|CreateSnowOrganizationAccountAccessRoleInMemberAccount|Yes|(1) Management or Designated Member Account ID <br/> (2) S3 bucket name to store SendCommand output <br/> (3)ServiceNow User Name|ARN of ServiceNow Designated Account Access Role|This template creates the SnowDesignatedAccountAccessRole IAM role in member accounts, used by the ServiceNow user. It establishes trust between the management or designated account and all member accounts. The CloudFormation template can be deployed as StackSet which will be deployed in all member accounts. If you are using Terraform, then refer to 'memberrole-propagation' module. |
|memberrole-propagation|createsnoworganizationaccountaccessroleinmemberaccount|Conditional|(1) Assume Role ARN defined in Member Account. eg.arn:aws:iam::123456789012:role/SnowCrossAccountAccessPolicy  <br/>  (2) Management or Designated Member Account ID  <br/>  (3) S3 bucket name to store SendCommand output  </br>  (4) ServiceNow User Name|ARN of ServiceNow Designated Account Access Role|This Terraform template is used to establish trust between the account where ServiceNow user is created to all member accounts. |
|createuser|CreateServiceNowUser|Yes|ServiceNow Username, Member Account Role Name|ARN of ServiceNow user|Script to create ServiceNow user and assign to SnowOrganizationAccountAccessRole role|
|enableconfig|EnableAWSConfig|Optional|(1) Whether to create an SNS topic for Config notifications (true/false), default - false <br/> (2) Email address for SNS notifications <br/> (3)  Record all supported resource types (true/false), default true <br/> (4) Include global resource types (true/false), default - true <br/> (5) Specific resource types to record <br/> (6) Optional delivery channel name <br/> (7) Snapshot delivery frequency (e.g., One_Hour, Three_Hours), default One_Hour||This template enables AWS Config in specific account region. The CloudFormation template when deployed as StackSet, can be enabled in all the desired accounts. |
|ssminstancerole|AmazonSSMForInstancesRoleSetup|Optional|Enter the S3 bucket name you have created/chosen to publish SendCommand output.|AmazonSSMForInstancesProfile|This template is used to attach with EC2 template which enables SSM to interact with EC2 instance.This role grants EC2 instances permissions to use AWS Systems Manager features like Run Command, Patch Manager, and Session Manager.|
|ssmlinux|SG-AWS-RunShellScript-Setup|Optional|None|Command output sent to S3 bucket|This templates deploys script in AWS Systems Manager. This script is used to get OS level information like netstat, ps, hostname etc in Linux instance.|
|ssmwindows|SG-AWS-RunPowerShellScript-Setup|Optional|None|Command output sent to S3 bucket|This templates deploys script in AWS Systems Manager. This script is used to get OS level information like netstat, ps, hostname etc in Windows instance.|
|ssmkubeeks|SG-AWS-RunKubeCtlEKSNamesShellScript|Optional|None|Command output sent to S3 bucket|This templates deploys script in AWS Systems Manager. This script is used to get EKS cluster information into CMDB. |
|ssmkubeshell|SG-AWS-RunKubeCtlShellScript|Optional|None|Command output sent to S3 bucket|This templates deploys script in AWS Systems Manager. This script is used to get EKS indepth details like Namespace, Service, Deployments, PODS, Replicaset etc|
|ssmadminrole|AWS-SystemsManager-AutomationAdministrationRole|Optional|None|None|This template is deployed in Management account to enable SSM setup across member accounts from Management account. This script will allow admin to setup SSM across member accounts.|
|ssmexecrole|AWS-SystemsManager-AutomationExecutionRole|Optional|None|None|This template is deployed in Management account to enable SSM setup across member accounts from Management account. This script will allow admin to setup SSM across member accounts.|


